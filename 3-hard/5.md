## Total Server Fleet Uptime in Full Days
 
Using the 'playground.sessions' table, write a SQL query to calculate the total uptime of the server fleet in full days. The table records each server's start and stop times as separate entries. The total uptime ('total_uptime_days') is defined as the sum of all periods during which any server was running, represented as a single integer value for the total number of full days. Assume each 'start' session_status has a corresponding 'stop' status, and sessions do not overlap for the same server.

### These are the tables to query for this question:
**playground.sessions**
- session_id int
- session_time date
- session_status string
### Your answer should include these columns:
- total_uptime_days integer

## Answer
```sql
-- my version (simple)
WITH A AS (
  SELECT
    session_id,
    DATE_DIFF('day',
      MIN(session_time),
      MAX(session_time)
    ) AS uptime_days
  FROM playground.sessions
  GROUP BY session_id
)
SELECT sum(uptime_days) AS total_uptime_days
FROM A;

-- intened version
WITH A AS (
  SELECT
    session_id,
    MIN(CASE WHEN session_status = 'start' THEN session_time END) AS start_time,
    MAX(CASE WHEN session_status = 'stop'  THEN session_time END) AS stop_time
  FROM playground.sessions
  GROUP BY session_id
)
SELECT SUM(DATE_DIFF('DAY', start_time, stop_time))
    AS total_uptime_days
FROM A
```

## Results
| total_uptime_days |
|-------------------|
| 15                |

