## Countries and Their Preferences for Beer, Spirit, and Wine
 
Create a SQL query to find all countries and their preference for beer, spirit, and wine, based on the highest serving type as their preference. The output should show only the countries whose preferences are wine and spirits, ordered in ascending order of the country name.

### These are the tables to query for this question:
**playground.drinks**
- country string
- beer_servings int
- spirit_servings int
- wine_servings int
- total_litres_of_pure_alcohol double
### Your answer should include these columns:
- country varchar
- preferred_drink varchar

## Answer
```sql
WITH A AS (
  SELECT
    country,
    CASE 
      WHEN beer_servings > GREATEST(spirit_servings, wine_servings)
      THEN 'Beer'
      WHEN spirit_servings > GREATEST(beer_servings, wine_servings)
      THEN 'Spirit'
      WHEN wine_servings > GREATEST(beer_servings, spirit_servings)
      THEN 'Wine'
      ELSE NULL
    END AS preferred_drink
  FROM playground.drinks
)
SELECT * FROM A
WHERE preferred_drink IN ('Spirit', 'Wine')
ORDER BY 1
```

## Results
| country                      | preferred_drink |
|------------------------------|-----------------|
| Albania                      | Spirit          |
| Andorra                      | Wine            |
| Antigua & Barbuda            | Spirit          |
| Argentina                    | Wine            |
| Armenia                      | Spirit          |
| Azerbaijan                   | Spirit          |
| Bahamas                      | Spirit          |
| Bahrain                      | Spirit          |
| Barbados                     | Spirit          |
| Belarus                      | Spirit          |
| Bosnia-Herzegovina           | Spirit          |
| Bulgaria                     | Spirit          |
| Cambodia                     | Spirit          |
| Chile                        | Wine            |
| China                        | Spirit          |
| Comoros                      | Spirit          |
| Cook Islands                 | Spirit          |
| Croatia                      | Wine            |
| Cuba                         | Spirit          |
| Denmark                      | Wine            |
| Djibouti                     | Spirit          |
| Dominica                     | Spirit          |
| El Salvador                  | Spirit          |
| Equatorial Guinea            | Wine            |
| France                       | Wine            |
| Georgia                      | Wine            |
| Greece                       | Wine            |
| Grenada                      | Spirit          |
| Guatemala                    | Spirit          |
| Guinea-Bissau                | Spirit          |
| Guyana                       | Spirit          |
| Haiti                        | Spirit          |
| Honduras                     | Spirit          |
| India                        | Spirit          |
| Israel                       | Spirit          |
| Italy                        | Wine            |
| Jamaica                      | Spirit          |
| Japan                        | Spirit          |
| Jordan                       | Spirit          |
| Kazakhstan                   | Spirit          |
| Kiribati                     | Spirit          |
| Kyrgyzstan                   | Spirit          |
| Laos                         | Wine            |
| Lebanon                      | Spirit          |
| Liberia                      | Spirit          |
| Luxembourg                   | Wine            |
| Malawi                       | Spirit          |
| Moldova                      | Spirit          |
| Mongolia                     | Spirit          |
| Montenegro                   | Wine            |
| Nepal                        | Spirit          |
| Nicaragua                    | Spirit          |
| Niue                         | Spirit          |
| Philippines                  | Spirit          |
| Portugal                     | Wine            |
| Qatar                        | Spirit          |
| Russian Federation           | Spirit          |
| Sao Tome & Principe          | Wine            |
| Saudi Arabia                 | Spirit          |
| Slovakia                     | Spirit          |
| Slovenia                     | Wine            |
| Sri Lanka                    | Spirit          |
| St. Kitts & Nevis            | Spirit          |
| St. Lucia                    | Spirit          |
| St. Vincent & the Grenadines | Spirit          |
| Sudan                        | Spirit          |
| Suriname                     | Spirit          |
| Sweden                       | Wine            |
| Switzerland                  | Wine            |
| Syria                        | Spirit          |
| Tajikistan                   | Spirit          |
| Thailand                     | Spirit          |
| Timor-Leste                  | Wine            |
| Turkmenistan                 | Spirit          |
| Tuvalu                       | Spirit          |
| Ukraine                      | Spirit          |
| United Arab Emirates         | Spirit          |
| Uruguay                      | Wine            |
| Uzbekistan                   | Spirit          |
