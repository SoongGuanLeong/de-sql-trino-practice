## Count Unique Conversation Threads
 
Using the table playground.messenger, write a SQL query to find the number of unique conversation threads in the playground.messenger table. A conversation thread is identified by the sender_id and receiver_id columns. Note that if a thread has sender_id and receiver_id inverted in another row, it should still be counted as the same thread. For example, a conversation where sender_id=1 and receiver_id=2 should be considered the same thread as one where sender_id=2 and receiver_id=1. The result should just be a single column called count given in any order.

### These are the tables to query for this question:
**playground.messenger**
- sender_id int
- receiver_id int
### Your answer should include these columns:
- count integer


## Answer
```sql
-- my version
WITH A AS (
  SELECT 
    COALESCE(m1.sender_id, m2.receiver_id) AS sender_id,
    COALESCE(m1.receiver_id, m2.sender_id) AS receiver_id
  FROM playground.messenger m1 FULL OUTER JOIN playground.messenger m2
  ON m1.sender_id = m2.receiver_id
  AND m1.receiver_id = m2.sender_id
  WHERE COALESCE(m1.sender_id, m2.receiver_id) < COALESCE(m1.receiver_id, m2.sender_id)
)
SELECT COUNT(DISTINCT (sender_id, receiver_id)) AS count
FROM A

-- GPT version
SELECT 
    COUNT(DISTINCT 
    (LEAST(sender_id, receiver_id), 
    GREATEST(sender_id, receiver_id))) AS count
FROM playground.messenger;
```

## Results
| count |
|-------|
| 6     |