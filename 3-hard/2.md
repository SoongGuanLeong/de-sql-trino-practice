## Determining Optimal Packaging for Christmas Gifts
 
Given two tables, playground.gifts and playground.packages, write a SQL query to match each gift to the smallest package it fits into based on dimensions. A gift fits in a package if its dimensions are less than or equal to those of the package. A package is considered smaller than another if its volume is smaller. Each package can hold only one gift. Produce a table with columns: package_type and number, where number indicates how many gifts are matched to each package_type. Exclude package types not used. Sort the result by package_type in ascending order. Assume every gift fits in at least one package and no two packages have the same volume.

### These are the tables to query for this question:
**playground.gifts**
- id int
- gift_name string
- length int
- width int
- height int
- playground.packages
- package_type string
- length int
- width int
- height int
### Your answer should include these columns:
- package_type varchar
- number integer

## Answer
```sql
WITH A AS (
  SELECT package_type, length AS l, width AS w, height AS h,
    ROW_NUMBER() OVER (ORDER BY (length * width * height)) AS rnk
  FROM playground.packages
),
B AS (
  SELECT id, gift_name, length, width, height,
    MIN(CASE WHEN length <= l AND width <= w AND height <= h THEN rnk
    END) AS rnk
  FROM playground.gifts CROSS JOIN A
  GROUP BY 1,2,3,4,5
)
SELECT package_type, 
  COUNT(package_type) AS number
FROM B JOIN A
ON B.rnk = A.rnk
GROUP BY 1
ORDER BY 1
```

## Results
| package_type | number |
|--------------|--------|
| big          | 2      |
| medium       | 1      |
| small        | 1      |
| special      | 1      |