## Identifying Multi-Component Bugs and Their Impact
 
Analyze the playground.bug, playground.component, and playground.bug_component tables to identify bugs affecting multiple components. Bug table contains num (unique bug number) and title (bug title). Component table includes id (unique component id) and title (component title). BugComponent table links bugs to components with bug_num (references Bug.num) and component_id (references Component.id). The task is to list each bug (that affects more than one component) with the titles of affected components and the total number of bugs in these components. Output columns: bug_title, component_title, bugs_in_component, ordered by bugs_in_component (descending), then by bug_title (ascending).

### These are the tables to query for this question:
#### **playground.bug**
- num int
- title string
#### **playground.component**
- id int
- title string
#### **playground.bug_component**
- bug_num int
- component_id int
### Your answer should include these columns:
- bug_title varchar
- component_title varchar
- bugs_in_component integer

## Answer
```sql
WITH A AS (
  SELECT 
    COALESCE(bc.bug_num, b.num) AS bug_num,
    b.title AS bug_title,
    COALESCE(bc.component_id, c.id) AS component_id,
    c.title AS component_title
  FROM playground.bug_component bc 
  FULL OUTER JOIN playground.bug b
  ON bc.bug_num = b.num
  FULL OUTER JOIN playground.component c
  ON bc.component_id = c.id
), B AS (
  SELECT bug_title, component_title, 
    COUNT(component_title) 
    OVER(PARTITION BY component_title) AS bugs_in_component,
    COUNT(component_title) 
    OVER(PARTITION BY bug_title) AS components_in_bug
  FROM A
)
SELECT bug_title, component_title,
  bugs_in_component
FROM B
WHERE components_in_bug > 1
ORDER BY 3 DESC, 1
```


## Results
| bug_title                | component_title | bugs_in_component |
|--------------------------|-----------------|-------------------|
| Author link doesn't work | Forum           | 4                 |
| Highlighting looks weird | Forum           | 4                 |
| Author link doesn't work | Code editor     | 2                 |
| Highlighting looks weird | Code editor     | 2                 |