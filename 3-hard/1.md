## Calculating Median Searches per User
 
Using the table playground.search_freq with each row representing the number of searches (searches column) made by a certain number of users (users column), write a SQL query to calculate the median number of searches per user up to one decimal place and be sure to cast it as a double.

### These are the tables to query for this question:
**playground.search_freq**
- searches int
- num_users int
### Your answer should include these columns:
- median double

## Answer
```sql
-- my version, brute force manually
WITH A AS (
    SELECT *,
    SUM(num_users) 
      OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)
    AS cum_no_users
  FROM playground.search_freq
), 
B AS (
  SELECT (SUM(num_users) + 1) / 2.0 AS median_loc
  FROM playground.search_freq
)
SELECT CAST((
  MIN(CASE WHEN cum_no_users >= FLOOR(median_loc) THEN searches END)
  +
  MIN(CASE WHEN cum_no_users >= CEIL(median_loc) THEN searches END)
) / 2.0 AS DOUBLE) AS median
FROM A CROSS JOIN B


-- use Trino built in function (if big data)
-- close but not accurate
SELECT 
  approx_percentile(
    CAST(searches AS DOUBLE), 
    CAST(num_users AS DOUBLE), 
    0.50
) AS median
FROM playground.search_freq

```

## Results
| median |
|--------|
| 2.5    |