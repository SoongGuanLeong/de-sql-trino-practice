## Find Product Prices
 
Using the table playground.product_prices, create a SQL query to find all products and their prices on 2023-08-17, assuming the initial price of all products was 10 before any price changes. Order the results in ascending order of product_id.

### These are the tables to query for this question:
**playground.product_prices**
- product_id int
- new_price int
- change_date date
### Your answer should include these columns:
- product_id integer
- price integer

```sql
-- Written by me
WITH A AS (
  SELECT
    *,
    ROW_NUMBER() 
      OVER(PARTITION BY product_id 
      ORDER BY change_date DESC) AS row_num
  FROM playground.product_prices
  WHERE change_date <= DATE '2023-08-17'
),
B AS (
  SELECT DISTINCT product_id
  FROM playground.product_prices
),
C AS (
  SELECT * FROM A
  WHERE row_num=1
)
SELECT 
  B.product_id,
  COALESCE(new_price, 10) AS price
FROM B FULL OUTER JOIN C
ON B.product_id = C.product_id
ORDER BY 1


-- shorten version by GPT
WITH latest AS (
  SELECT
    product_id,
    new_price,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY change_date DESC
    ) AS row_num
  FROM playground.product_prices
  WHERE change_date <= DATE '2023-08-17'
)
SELECT
  p.product_id,
  COALESCE(l.new_price, 10) AS price
FROM (SELECT DISTINCT product_id FROM playground.product_prices) p
LEFT JOIN latest l
  ON p.product_id = l.product_id
  AND l.row_num = 1
ORDER BY p.product_id;
```

## Results
| product_id | price |
|------------|-------|
| 1          | 35    |
| 2          | 50    |
| 3          | 10    |
