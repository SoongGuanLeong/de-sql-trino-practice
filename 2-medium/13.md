## Most Popular Fuel System for Each Fuel Type
 
Using the table playground.automobile, create a SQL query to find the most popular fuel system for each fuel type based on the number of cars. Include columns for fuel type, fuel system, and the count of cars, showing only the top fuel system for each fuel type. Order the result on the basis of fuel type in ascending order.

### These are the tables to query for this question:
**playground.automobile**
- brand_name string
- fuel_type string
- aspiration string
- door_panel string
- design string
- wheel_drive string
- engine_location string
- engine_type string
- cylinder_count string
- engine_size int
- fuel_system string
- bore double
- stroke double
- compression_ratio double
- horse_power int
- top_RPM int
- city_mileage int
- highway_mileage int
- price_in_dollars int
### Your answer should include these columns:
- fuel_type varchar
- fuel_system varchar
- total_cars integer

## Answer
```sql
WITH A AS (
  SELECT
    fuel_type, fuel_system,
    COUNT(fuel_system) AS total_cars,
    ROW_NUMBER() OVER (
      PARTITION BY fuel_type
      ORDER BY COUNT(fuel_system) DESC) AS row_num
  FROM playground.automobile
  GROUP BY fuel_type, fuel_system
)
SELECT fuel_type, fuel_system, total_cars
FROM A
WHERE row_num=1
ORDER BY fuel_type
```

## Results
| fuel_type | fuel_system | total_cars |
|-----------|-------------|------------|
| diesel    | idi         | 20         |
| gas       | mpfi        | 94         |
