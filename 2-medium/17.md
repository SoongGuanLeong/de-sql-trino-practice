## Finding Actors by Favorite Movie Genre
 
Given three tables - playground.movies, playground.starring_actors, and playground.actor_ages - identify actors from the most common movie genre in your library. Assume each actor is listed once representing their best role. The task is to list actors with their age, sorted from oldest to youngest, who star in movies of your favorite genre (the most common genre in your list). In case of actors being the same age, sort them by name.The resultant table should have two columns, actor and age.

### These are the tables to query for this question:
**playground.movies**
- movie string
- genre string
**playground.starring_actors**
- id int
- movie_name string
- actor string
**playground.actor_ages**
- actor string
- age int
### Your answer should include these columns:
- actor varchar
- age integer

## Answer
```sql
WITH A AS (
  SELECT
    id,
    COALESCE(a.movie_name, m.movie) AS movie_name,
    COALESCE(a.actor, aa.actor) AS actor,
    genre,
    age
  FROM playground.movies m
  FULL OUTER JOIN playground.starring_actors a
  ON m.movie = a.movie_name
  FULL OUTER JOIN playground.actor_ages aa
  ON a.actor = aa.actor
)
SELECT actor, age FROM A
WHERE genre = ( SELECT genre FROM (
                        SELECT genre, COUNT(genre) FROM A
                        GROUP BY genre
                        ORDER BY 2 DESC
                        LIMIT 1)
  )
ORDER BY age DESC, actor
```

## Results
| actor                | age |
|----------------------|-----|
| Keanu Reeves         | 52  |
| Amy Adams            | 42  |
| Michael Shannon      | 42  |
| Jake Gyllenhaal      | 36  |
| Sarah Gadon          | 29  |
| Aaron Taylor-Johnson | 26  |
| Elle Fanning         | 18  |