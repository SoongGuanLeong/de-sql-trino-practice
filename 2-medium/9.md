## Top 2 Customers with Highest Sales Every Month
 
Using the table playground.sales, Identify the top 2 customers based on their total sales for each month. Display the result based on asc order of their rank and month.

### These are the tables to query for this question:
**playground.sales**
- id int
- month string
- sales int
### Your answer should include these columns:
- id integer
- month varchar
- total_sales integer
- rank integer

## Answer
```sql
With agg AS (
  SELECT id, month, SUM(sales) AS total_sales
  FROM playground.sales
  GROUP BY id, month
),
ranked AS (
  SELECT *,
    ROW_NUMBER() OVER(
      PARTITION BY month
      ORDER BY total_sales DESC
    ) AS rank
  FROM agg
)
SELECT * FROM ranked
WHERE rank IN (1,2)
ORDER BY month DESC, rank
```

## Results
| id  | month | total_sales | rank |
|-----|-------|-------------|------|
| 100 | Jan   | 500         | 1    |
| 102 | Jan   | 400         | 2    |
| 103 | Feb   | 700         | 1    |
| 105 | Feb   | 600         | 2    |