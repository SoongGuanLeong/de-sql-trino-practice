## Filtering Dance Contest Scores
 
Given a table playground.dance_scores (columns: arbiter_id, first_criterion, second_criterion, third_criterion) with scores from 1 to 10 awarded by judges in a dance contest, write a query to exclude scores from any judge who awarded an extreme score (either minimum or maximum) for at least two criteria. Return the filtered scores, sorted by arbiter_id.

### These are the tables to query for this question:
**playground.dance_scores**
- arbiter_id int
- first_criterion int
- second_criterion int
- third_criterion int
### Your answer should include these columns:
- arbiter_id integer
- first_criterion integer
- second_criterion integer
- third_criterion integer

## Answer
```sql
WITH A AS (
  SELECT
    MAX(first_criterion) AS max_first,
    MIN(first_criterion) AS min_first,
    MAX(second_criterion) AS max_second,
    MIN(second_criterion) AS min_second,
    MAX(third_criterion) AS max_third,
    MIN(third_criterion) AS min_third
  FROM playground.dance_scores
), 
B AS (
  SELECT *,
    CASE WHEN first_criterion = max_first OR first_criterion = min_first THEN 1 ELSE 0
    END AS extreme_first,
    CASE WHEN second_criterion = max_second OR second_criterion = min_second THEN 1 ELSE 0
    END AS extreme_second,
    CASE WHEN third_criterion = max_third OR third_criterion = min_third THEN 1 ELSE 0
    END AS extreme_third
  FROM playground.dance_scores
  CROSS JOIN A
)
SELECT arbiter_id, first_criterion, second_criterion, third_criterion FROM B
WHERE extreme_first + extreme_second + extreme_third < 2
ORDER BY 1
```

## Results
| arbiter_id | first_criterion | second_criterion | third_criterion |
|------------|-----------------|------------------|-----------------|
| 2          | 2               | 3                | 4               |
| 3          | 5               | 6                | 7               |
| 4          | 2               | 5                | 9               |